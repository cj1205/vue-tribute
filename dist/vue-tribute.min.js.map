{"version":3,"file":"vue-tribute.min.js","sources":["../node_modules/tributejs/dist/utils.js","../node_modules/tributejs/dist/TributeEvents.js","../node_modules/tributejs/dist/TributeMenuEvents.js","../node_modules/tributejs/dist/TributeRange.js","../node_modules/tributejs/dist/TributeSearch.js","../node_modules/tributejs/dist/tribute.js","../src/index.js"],"sourcesContent":["'use strict';\n\nif (!Array.prototype.find) {\n    Array.prototype.find = function (predicate) {\n        if (this === null) {\n            throw new TypeError('Array.prototype.find called on null or undefined');\n        }\n        if (typeof predicate !== 'function') {\n            throw new TypeError('predicate must be a function');\n        }\n        var list = Object(this);\n        var length = list.length >>> 0;\n        var thisArg = arguments[1];\n        var value;\n\n        for (var i = 0; i < length; i++) {\n            value = list[i];\n            if (predicate.call(thisArg, value, i, list)) {\n                return value;\n            }\n        }\n        return undefined;\n    };\n}\n\nif (window && typeof window.CustomEvent !== \"function\") {\n    var CustomEvent = function CustomEvent(event, params) {\n        params = params || {\n            bubbles: false,\n            cancelable: false,\n            detail: undefined\n        };\n        var evt = document.createEvent('CustomEvent');\n        evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n        return evt;\n    };\n\n    if (typeof window.Event !== 'undefined') {\n        CustomEvent.prototype = window.Event.prototype;\n    }\n\n    window.CustomEvent = CustomEvent;\n}","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar TributeEvents = function () {\n    function TributeEvents(tribute) {\n        _classCallCheck(this, TributeEvents);\n\n        this.tribute = tribute;\n        this.tribute.events = this;\n    }\n\n    _createClass(TributeEvents, [{\n        key: 'bind',\n        value: function bind(element) {\n            element.boundKeydown = this.keydown.bind(element, this);\n            element.boundKeyup = this.keyup.bind(element, this);\n            element.boundInput = this.input.bind(element, this);\n\n            element.addEventListener('keydown', element.boundKeydown, false);\n            element.addEventListener('keyup', element.boundKeyup, false);\n            element.addEventListener('input', element.boundInput, false);\n        }\n    }, {\n        key: 'unbind',\n        value: function unbind(element) {\n            element.removeEventListener('keydown', element.boundKeydown, false);\n            element.removeEventListener('keyup', element.boundKeyup, false);\n            element.removeEventListener('input', element.boundInput, false);\n\n            delete element.boundKeydown;\n            delete element.boundKeyup;\n            delete element.boundInput;\n        }\n    }, {\n        key: 'keydown',\n        value: function keydown(instance, event) {\n            if (instance.shouldDeactivate(event)) {\n                instance.tribute.isActive = false;\n                instance.tribute.hideMenu();\n            }\n\n            var element = this;\n            instance.commandEvent = false;\n\n            TributeEvents.keys().forEach(function (o) {\n                if (o.key === event.keyCode) {\n                    instance.commandEvent = true;\n                    instance.callbacks()[o.value.toLowerCase()](event, element);\n                }\n            });\n        }\n    }, {\n        key: 'input',\n        value: function input(instance, event) {\n            instance.inputEvent = true;\n            instance.keyup.call(this, instance, event);\n        }\n    }, {\n        key: 'click',\n        value: function click(instance, event) {\n            var tribute = instance.tribute;\n            if (tribute.menu && tribute.menu.contains(event.target)) {\n                var li = event.target;\n                event.preventDefault();\n                event.stopPropagation();\n                while (li.nodeName.toLowerCase() !== 'li') {\n                    li = li.parentNode;\n                    if (!li || li === tribute.menu) {\n                        throw new Error('cannot find the <li> container for the click');\n                    }\n                }\n                tribute.selectItemAtIndex(li.getAttribute('data-index'), event);\n                tribute.hideMenu();\n\n                // TODO: should fire with externalTrigger and target is outside of menu\n            } else if (tribute.current.element && !tribute.current.externalTrigger) {\n                tribute.current.externalTrigger = false;\n                setTimeout(function () {\n                    return tribute.hideMenu();\n                });\n            }\n        }\n    }, {\n        key: 'keyup',\n        value: function keyup(instance, event) {\n            if (instance.inputEvent) {\n                instance.inputEvent = false;\n            }\n            instance.updateSelection(this);\n\n            if (event.keyCode === 27) return;\n\n            if (!instance.tribute.isActive) {\n                var keyCode = instance.getKeyCode(instance, this, event);\n\n                if (isNaN(keyCode) || !keyCode) return;\n\n                var trigger = instance.tribute.triggers().find(function (trigger) {\n                    return trigger.charCodeAt(0) === keyCode;\n                });\n\n                if (typeof trigger !== 'undefined') {\n                    instance.callbacks().triggerChar(event, this, trigger);\n                }\n            }\n\n            if (instance.tribute.current.trigger && instance.commandEvent === false || instance.tribute.isActive && event.keyCode === 8) {\n                instance.tribute.showMenuFor(this, true);\n            }\n        }\n    }, {\n        key: 'shouldDeactivate',\n        value: function shouldDeactivate(event) {\n            if (!this.tribute.isActive) return false;\n\n            if (this.tribute.current.mentionText.length === 0) {\n                var eventKeyPressed = false;\n                TributeEvents.keys().forEach(function (o) {\n                    if (event.keyCode === o.key) eventKeyPressed = true;\n                });\n\n                return !eventKeyPressed;\n            }\n\n            return false;\n        }\n    }, {\n        key: 'getKeyCode',\n        value: function getKeyCode(instance, el, event) {\n            var char = void 0;\n            var tribute = instance.tribute;\n            var info = tribute.range.getTriggerInfo(false, false, true, tribute.allowSpaces);\n\n            if (info) {\n                return info.mentionTriggerChar.charCodeAt(0);\n            } else {\n                return false;\n            }\n        }\n    }, {\n        key: 'updateSelection',\n        value: function updateSelection(el) {\n            this.tribute.current.element = el;\n            var info = this.tribute.range.getTriggerInfo(false, false, true, this.tribute.allowSpaces);\n\n            if (info) {\n                this.tribute.current.selectedPath = info.mentionSelectedPath;\n                this.tribute.current.mentionText = info.mentionText;\n                this.tribute.current.selectedOffset = info.mentionSelectedOffset;\n            }\n        }\n    }, {\n        key: 'callbacks',\n        value: function callbacks() {\n            var _this = this;\n\n            return {\n                triggerChar: function triggerChar(e, el, trigger) {\n                    var tribute = _this.tribute;\n                    tribute.current.trigger = trigger;\n\n                    var collectionItem = tribute.collection.find(function (item) {\n                        return item.trigger === trigger;\n                    });\n\n                    tribute.current.collection = collectionItem;\n                    if (tribute.inputEvent) tribute.showMenuFor(el, true);\n                },\n                enter: function enter(e, el) {\n                    // choose selection\n                    if (_this.tribute.isActive) {\n                        e.preventDefault();\n                        e.stopPropagation();\n                        setTimeout(function () {\n                            _this.tribute.selectItemAtIndex(_this.tribute.menuSelected, e);\n                            _this.tribute.hideMenu();\n                        }, 0);\n                    }\n                },\n                escape: function escape(e, el) {\n                    if (_this.tribute.isActive) {\n                        e.preventDefault();\n                        e.stopPropagation();\n                        _this.tribute.isActive = false;\n                        _this.tribute.hideMenu();\n                    }\n                },\n                tab: function tab(e, el) {\n                    // choose first match\n                    _this.callbacks().enter(e, el);\n                },\n                up: function up(e, el) {\n                    // navigate up ul\n                    if (_this.tribute.isActive) {\n                        e.preventDefault();\n                        e.stopPropagation();\n                        var count = _this.tribute.current.filteredItems.length,\n                            selected = _this.tribute.menuSelected;\n\n                        if (count > selected && selected > 0) {\n                            _this.tribute.menuSelected--;\n                            _this.setActiveLi();\n                        } else if (selected === 0) {\n                            _this.tribute.menuSelected = count - 1;\n                            _this.setActiveLi();\n                            _this.tribute.menu.scrollTop = _this.tribute.menu.scrollHeight;\n                        }\n                    }\n                },\n                down: function down(e, el) {\n                    // navigate down ul\n                    if (_this.tribute.isActive) {\n                        e.preventDefault();\n                        e.stopPropagation();\n                        var count = _this.tribute.current.filteredItems.length - 1,\n                            selected = _this.tribute.menuSelected;\n\n                        if (count > selected) {\n                            _this.tribute.menuSelected++;\n                            _this.setActiveLi();\n                        } else if (count === selected) {\n                            _this.tribute.menuSelected = 0;\n                            _this.setActiveLi();\n                            _this.tribute.menu.scrollTop = 0;\n                        }\n                    }\n                },\n                delete: function _delete(e, el) {\n                    if (_this.tribute.isActive && _this.tribute.current.mentionText.length < 1) {\n                        _this.tribute.hideMenu();\n                    } else if (_this.tribute.isActive) {\n                        _this.tribute.showMenuFor(el);\n                    }\n                }\n            };\n        }\n    }, {\n        key: 'setActiveLi',\n        value: function setActiveLi(index) {\n            var lis = this.tribute.menu.querySelectorAll('li'),\n                length = lis.length >>> 0;\n\n            // get heights\n            var menuFullHeight = this.getFullHeight(this.tribute.menu),\n                liHeight = this.getFullHeight(lis[0]);\n\n            if (index) this.tribute.menuSelected = index;\n\n            for (var i = 0; i < length; i++) {\n                var li = lis[i];\n                if (i === this.tribute.menuSelected) {\n                    var offset = liHeight * (i + 1);\n                    var scrollTop = this.tribute.menu.scrollTop;\n                    var totalScroll = scrollTop + menuFullHeight;\n\n                    if (offset > totalScroll) {\n                        this.tribute.menu.scrollTop += liHeight;\n                    } else if (offset < totalScroll) {\n                        this.tribute.menu.scrollTop -= liHeight;\n                    }\n\n                    li.className = this.tribute.current.collection.selectClass;\n                } else {\n                    li.className = '';\n                }\n            }\n        }\n    }, {\n        key: 'getFullHeight',\n        value: function getFullHeight(elem, includeMargin) {\n            var height = elem.getBoundingClientRect().height;\n\n            if (includeMargin) {\n                var style = elem.currentStyle || window.getComputedStyle(elem);\n                return height + parseFloat(style.marginTop) + parseFloat(style.marginBottom);\n            }\n\n            return height;\n        }\n    }], [{\n        key: 'keys',\n        value: function keys() {\n            return [{\n                key: 9,\n                value: 'TAB'\n            }, {\n                key: 8,\n                value: 'DELETE'\n            }, {\n                key: 13,\n                value: 'ENTER'\n            }, {\n                key: 27,\n                value: 'ESCAPE'\n            }, {\n                key: 38,\n                value: 'UP'\n            }, {\n                key: 40,\n                value: 'DOWN'\n            }];\n        }\n    }]);\n\n    return TributeEvents;\n}();\n\nexports.default = TributeEvents;\nmodule.exports = exports['default'];","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar TributeMenuEvents = function () {\n    function TributeMenuEvents(tribute) {\n        _classCallCheck(this, TributeMenuEvents);\n\n        this.tribute = tribute;\n        this.tribute.menuEvents = this;\n        this.menu = this.tribute.menu;\n    }\n\n    _createClass(TributeMenuEvents, [{\n        key: 'bind',\n        value: function bind(menu) {\n            var _this = this;\n\n            menu.menuKeydownEvent = this.tribute.events.keydown.bind(this.menu, this);\n            this.menuClickEvent = this.tribute.events.click.bind(null, this);\n            this.menuContainerScrollEvent = this.debounce(function () {\n                if (_this.tribute.isActive) {\n                    _this.tribute.showMenuFor(_this.tribute.current.element, false);\n                }\n            }, 300, false);\n            this.windowResizeEvent = this.debounce(function () {\n                if (_this.tribute.isActive) {\n                    _this.tribute.range.positionMenuAtCaret(true);\n                }\n            }, 300, false);\n\n            // fixes IE11 issues with mousedown\n            this.tribute.range.getDocument().addEventListener('MSPointerDown', this.menuKeydownEvent, false);\n            menu.addEventListener('keydown', this.menuKeydownEvent, false);\n            this.tribute.range.getDocument().addEventListener('mousedown', this.menuClickEvent, false);\n            window.addEventListener('resize', this.windowResizeEvent);\n\n            if (this.menuContainer) {\n                this.menuContainer.addEventListener('scroll', this.menuContainerScrollEvent, false);\n            } else {\n                window.addEventListener('scroll', this.menuContainerScrollEvent);\n            }\n        }\n    }, {\n        key: 'unbind',\n        value: function unbind(menu) {\n            menu.removeEventListener('keydown', menu.menuKeydownEvent, false);\n            delete menu.menuKeydownEvent;\n            this.tribute.range.getDocument().removeEventListener('mousedown', this.menuClickEvent, false);\n            this.tribute.range.getDocument().removeEventListener('MSPointerDown', this.menuClickEvent, false);\n            window.removeEventListener('resize', this.windowResizeEvent);\n\n            if (this.menuContainer) {\n                this.menuContainer.removeEventListener('scroll', this.menuContainerScrollEvent, false);\n            } else {\n                window.removeEventListener('scroll', this.menuContainerScrollEvent);\n            }\n        }\n    }, {\n        key: 'debounce',\n        value: function debounce(func, wait, immediate) {\n            var _this2 = this,\n                _arguments = arguments;\n\n            var timeout;\n            return function () {\n                var context = _this2,\n                    args = _arguments;\n                var later = function later() {\n                    timeout = null;\n                    if (!immediate) func.apply(context, args);\n                };\n                var callNow = immediate && !timeout;\n                clearTimeout(timeout);\n                timeout = setTimeout(later, wait);\n                if (callNow) func.apply(context, args);\n            };\n        }\n    }]);\n\n    return TributeMenuEvents;\n}();\n\nexports.default = TributeMenuEvents;\nmodule.exports = exports['default'];","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Thanks to https://github.com/jeff-collins/ment.io\nvar TributeRange = function () {\n    function TributeRange(tribute) {\n        _classCallCheck(this, TributeRange);\n\n        this.tribute = tribute;\n        this.tribute.range = this;\n    }\n\n    _createClass(TributeRange, [{\n        key: 'getDocument',\n        value: function getDocument() {\n            var iframe = void 0;\n            if (this.tribute.current.collection) {\n                iframe = this.tribute.current.collection.iframe;\n            }\n\n            if (!iframe) {\n                return document;\n            }\n\n            return iframe.contentWindow.document;\n        }\n    }, {\n        key: 'positionMenuAtCaret',\n        value: function positionMenuAtCaret(scrollTo) {\n            var _this = this;\n\n            var context = this.tribute.current,\n                coordinates = void 0;\n\n            var info = this.getTriggerInfo(false, false, true, this.tribute.allowSpaces);\n\n            if (typeof info !== 'undefined') {\n\n                if (!this.tribute.positionMenu) {\n                    this.tribute.menu.style.cssText = 'display: block;';\n                    return;\n                }\n\n                if (!this.isContentEditable(context.element)) {\n                    coordinates = this.getTextAreaOrInputUnderlinePosition(this.getDocument().activeElement, info.mentionPosition);\n                } else {\n                    coordinates = this.getContentEditableCaretPosition(info.mentionPosition);\n                }\n\n                this.tribute.menu.style.cssText = 'top: ' + coordinates.top + 'px;\\n                                     left: ' + coordinates.left + 'px;\\n                                     right: ' + coordinates.right + 'px;\\n                                     bottom: ' + coordinates.bottom + 'px;\\n                                     position: absolute;\\n                                     zIndex: 10000;\\n                                     display: block;';\n\n                if (coordinates.left === 'auto') {\n                    this.tribute.menu.style.left = 'auto';\n                }\n\n                if (coordinates.top === 'auto') {\n                    this.tribute.menu.style.top = 'auto';\n                }\n\n                if (scrollTo) this.scrollIntoView();\n\n                window.setTimeout(function () {\n                    var menuDimensions = {\n                        width: _this.tribute.menu.offsetWidth,\n                        height: _this.tribute.menu.offsetHeight\n                    };\n                    var menuIsOffScreen = _this.isMenuOffScreen(coordinates, menuDimensions);\n\n                    if (menuIsOffScreen.horizontally || menuIsOffScreen.vertically) {\n                        _this.tribute.menu.style.cssText = 'display: none';\n                        _this.positionMenuAtCaret(scrollTo);\n                    }\n                }, 0);\n            } else {\n                this.tribute.menu.style.cssText = 'display: none';\n            }\n        }\n    }, {\n        key: 'selectElement',\n        value: function selectElement(targetElement, path, offset) {\n            var range = void 0;\n            var elem = targetElement;\n\n            if (path) {\n                for (var i = 0; i < path.length; i++) {\n                    elem = elem.childNodes[path[i]];\n                    if (elem === undefined) {\n                        return;\n                    }\n                    while (elem.length < offset) {\n                        offset -= elem.length;\n                        elem = elem.nextSibling;\n                    }\n                    if (elem.childNodes.length === 0 && !elem.length) {\n                        elem = elem.previousSibling;\n                    }\n                }\n            }\n            var sel = this.getWindowSelection();\n\n            range = this.getDocument().createRange();\n            range.setStart(elem, offset);\n            range.setEnd(elem, offset);\n            range.collapse(true);\n\n            try {\n                sel.removeAllRanges();\n            } catch (error) {}\n\n            sel.addRange(range);\n            targetElement.focus();\n        }\n\n        // TODO: this may not be necessary anymore as we are using mouseup instead of click\n\n    }, {\n        key: 'resetSelection',\n        value: function resetSelection(targetElement, path, offset) {\n            if (!this.isContentEditable(targetElement)) {\n                if (targetElement !== this.getDocument().activeElement) {\n                    targetElement.focus();\n                }\n            } else {\n                this.selectElement(targetElement, path, offset);\n            }\n        }\n    }, {\n        key: 'replaceTriggerText',\n        value: function replaceTriggerText(text, requireLeadingSpace, hasTrailingSpace, originalEvent, item) {\n            var context = this.tribute.current;\n            // TODO: this may not be necessary anymore as we are using mouseup instead of click\n            // this.resetSelection(context.element, context.selectedPath, context.selectedOffset)\n\n            var info = this.getTriggerInfo(true, hasTrailingSpace, requireLeadingSpace, this.tribute.allowSpaces);\n\n            // Create the event\n            var replaceEvent = new CustomEvent('tribute-replaced', {\n                detail: {\n                    item: item,\n                    event: originalEvent\n                }\n            });\n\n            if (info !== undefined) {\n                if (!this.isContentEditable(context.element)) {\n                    var myField = this.getDocument().activeElement;\n                    var textSuffix = typeof this.tribute.replaceTextSuffix == 'string' ? this.tribute.replaceTextSuffix : ' ';\n                    text += textSuffix;\n                    var startPos = info.mentionPosition;\n                    var endPos = info.mentionPosition + info.mentionText.length + textSuffix.length;\n                    myField.value = myField.value.substring(0, startPos) + text + myField.value.substring(endPos, myField.value.length);\n                    myField.selectionStart = startPos + text.length;\n                    myField.selectionEnd = startPos + text.length;\n                } else {\n                    // add a space to the end of the pasted text\n                    var _textSuffix = typeof this.tribute.replaceTextSuffix == 'string' ? this.tribute.replaceTextSuffix : '\\xA0';\n                    text += _textSuffix;\n                    this.pasteHtml(text, info.mentionPosition, info.mentionPosition + info.mentionText.length + 1);\n                }\n\n                context.element.dispatchEvent(replaceEvent);\n            }\n        }\n    }, {\n        key: 'pasteHtml',\n        value: function pasteHtml(html, startPos, endPos) {\n            var range = void 0,\n                sel = void 0;\n            sel = this.getWindowSelection();\n            range = this.getDocument().createRange();\n            range.setStart(sel.anchorNode, startPos);\n            range.setEnd(sel.anchorNode, endPos);\n            range.deleteContents();\n\n            var el = this.getDocument().createElement('div');\n            el.innerHTML = html;\n            var frag = this.getDocument().createDocumentFragment(),\n                node = void 0,\n                lastNode = void 0;\n            while (node = el.firstChild) {\n                lastNode = frag.appendChild(node);\n            }\n            range.insertNode(frag);\n\n            // Preserve the selection\n            if (lastNode) {\n                range = range.cloneRange();\n                range.setStartAfter(lastNode);\n                range.collapse(true);\n                sel.removeAllRanges();\n                sel.addRange(range);\n            }\n        }\n    }, {\n        key: 'getWindowSelection',\n        value: function getWindowSelection() {\n            if (this.tribute.collection.iframe) {\n                return this.tribute.collection.iframe.contentWindow.getSelection();\n            }\n\n            return window.getSelection();\n        }\n    }, {\n        key: 'getNodePositionInParent',\n        value: function getNodePositionInParent(element) {\n            if (element.parentNode === null) {\n                return 0;\n            }\n\n            for (var i = 0; i < element.parentNode.childNodes.length; i++) {\n                var node = element.parentNode.childNodes[i];\n\n                if (node === element) {\n                    return i;\n                }\n            }\n        }\n    }, {\n        key: 'getContentEditableSelectedPath',\n        value: function getContentEditableSelectedPath(ctx) {\n            var sel = this.getWindowSelection();\n            var selected = sel.anchorNode;\n            var path = [];\n            var offset = void 0;\n\n            if (selected != null) {\n                var i = void 0;\n                var ce = selected.contentEditable;\n                while (selected !== null && ce !== 'true') {\n                    i = this.getNodePositionInParent(selected);\n                    path.push(i);\n                    selected = selected.parentNode;\n                    if (selected !== null) {\n                        ce = selected.contentEditable;\n                    }\n                }\n                path.reverse();\n\n                // getRangeAt may not exist, need alternative\n                offset = sel.getRangeAt(0).startOffset;\n\n                return {\n                    selected: selected,\n                    path: path,\n                    offset: offset\n                };\n            }\n        }\n    }, {\n        key: 'getTextPrecedingCurrentSelection',\n        value: function getTextPrecedingCurrentSelection() {\n            var context = this.tribute.current,\n                text = '';\n\n            if (!this.isContentEditable(context.element)) {\n                var textComponent = this.tribute.current.element;\n                if (textComponent) {\n                    var startPos = textComponent.selectionStart;\n                    if (textComponent.value && startPos >= 0) {\n                        text = textComponent.value.substring(0, startPos);\n                    }\n                }\n            } else {\n                var selectedElem = this.getWindowSelection().anchorNode;\n\n                if (selectedElem != null) {\n                    var workingNodeContent = selectedElem.textContent;\n                    var selectStartOffset = this.getWindowSelection().getRangeAt(0).startOffset;\n\n                    if (workingNodeContent && selectStartOffset >= 0) {\n                        text = workingNodeContent.substring(0, selectStartOffset);\n                    }\n                }\n            }\n\n            return text;\n        }\n    }, {\n        key: 'getTriggerInfo',\n        value: function getTriggerInfo(menuAlreadyActive, hasTrailingSpace, requireLeadingSpace, allowSpaces) {\n            var _this2 = this;\n\n            var ctx = this.tribute.current;\n            var selected = void 0,\n                path = void 0,\n                offset = void 0;\n\n            if (!this.isContentEditable(ctx.element)) {\n                selected = this.getDocument().activeElement;\n            } else {\n                var selectionInfo = this.getContentEditableSelectedPath(ctx);\n\n                if (selectionInfo) {\n                    selected = selectionInfo.selected;\n                    path = selectionInfo.path;\n                    offset = selectionInfo.offset;\n                }\n            }\n\n            var effectiveRange = this.getTextPrecedingCurrentSelection();\n\n            if (effectiveRange !== undefined && effectiveRange !== null) {\n                var mostRecentTriggerCharPos = -1;\n                var triggerChar = void 0;\n\n                this.tribute.collection.forEach(function (config) {\n                    var c = config.trigger;\n                    var idx = config.requireLeadingSpace ? _this2.lastIndexWithLeadingSpace(effectiveRange, c) : effectiveRange.lastIndexOf(c);\n\n                    if (idx > mostRecentTriggerCharPos) {\n                        mostRecentTriggerCharPos = idx;\n                        triggerChar = c;\n                        requireLeadingSpace = config.requireLeadingSpace;\n                    }\n                });\n\n                if (mostRecentTriggerCharPos >= 0 && (mostRecentTriggerCharPos === 0 || !requireLeadingSpace || /[\\xA0\\s]/g.test(effectiveRange.substring(mostRecentTriggerCharPos - 1, mostRecentTriggerCharPos)))) {\n                    var currentTriggerSnippet = effectiveRange.substring(mostRecentTriggerCharPos + 1, effectiveRange.length);\n\n                    triggerChar = effectiveRange.substring(mostRecentTriggerCharPos, mostRecentTriggerCharPos + 1);\n                    var firstSnippetChar = currentTriggerSnippet.substring(0, 1);\n                    var leadingSpace = currentTriggerSnippet.length > 0 && (firstSnippetChar === ' ' || firstSnippetChar === '\\xA0');\n                    if (hasTrailingSpace) {\n                        currentTriggerSnippet = currentTriggerSnippet.trim();\n                    }\n\n                    var regex = allowSpaces ? /[^\\S ]/g : /[\\xA0\\s]/g;\n\n                    if (!leadingSpace && (menuAlreadyActive || !regex.test(currentTriggerSnippet))) {\n                        return {\n                            mentionPosition: mostRecentTriggerCharPos,\n                            mentionText: currentTriggerSnippet,\n                            mentionSelectedElement: selected,\n                            mentionSelectedPath: path,\n                            mentionSelectedOffset: offset,\n                            mentionTriggerChar: triggerChar\n                        };\n                    }\n                }\n            }\n        }\n    }, {\n        key: 'lastIndexWithLeadingSpace',\n        value: function lastIndexWithLeadingSpace(str, char) {\n            var reversedStr = str.split('').reverse().join('');\n            var index = -1;\n\n            for (var cidx = 0, len = str.length; cidx < len; cidx++) {\n                var firstChar = cidx === str.length - 1;\n                var leadingSpace = /\\s/.test(reversedStr[cidx + 1]);\n                var match = char === reversedStr[cidx];\n\n                if (match && (firstChar || leadingSpace)) {\n                    index = str.length - 1 - cidx;\n                    break;\n                }\n            }\n\n            return index;\n        }\n    }, {\n        key: 'isContentEditable',\n        value: function isContentEditable(element) {\n            return element.nodeName !== 'INPUT' && element.nodeName !== 'TEXTAREA';\n        }\n    }, {\n        key: 'isMenuOffScreen',\n        value: function isMenuOffScreen(coordinates, menuDimensions) {\n            var contentWidth = menuDimensions.width + coordinates.left;\n            var contentHeight = menuDimensions.height + coordinates.top;\n\n            var windowWidth = window.innerWidth;\n            var windowHeight = window.innerHeight;\n            var doc = document.documentElement;\n            var windowLeft = (window.pageXOffset || doc.scrollLeft) - (doc.clientLeft || 0);\n            var windowTop = (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);\n\n            return {\n                horizontally: Math.ceil(contentWidth - windowLeft) >= windowWidth,\n                vertically: Math.ceil(contentHeight - windowTop) >= windowHeight\n            };\n        }\n    }, {\n        key: 'getMenuDimensions',\n        value: function getMenuDimensions() {\n            // Width of the menu depends of its contents and position\n            // We must check what its width would be without any obstruction\n            // This way, we can achieve good positioning for flipping the menu\n            var dimensions = {\n                width: null,\n                height: null\n            };\n\n            this.tribute.menu.style.cssText = 'top: 0px;\\n                                 left: 0px;\\n                                 position: fixed;\\n                                 zIndex: 10000;\\n                                 display: block;\\n                                 visibility; hidden;';\n            dimensions.width = this.tribute.menu.offsetWidth;\n            dimensions.height = this.tribute.menu.offsetHeight;\n\n            this.tribute.menu.style.cssText = 'display: none;';\n\n            return dimensions;\n        }\n    }, {\n        key: 'getTextAreaOrInputUnderlinePosition',\n        value: function getTextAreaOrInputUnderlinePosition(element, position, flipped) {\n            var properties = ['direction', 'boxSizing', 'width', 'height', 'overflowX', 'overflowY', 'borderTopWidth', 'borderRightWidth', 'borderBottomWidth', 'borderLeftWidth', 'paddingTop', 'paddingRight', 'paddingBottom', 'paddingLeft', 'fontStyle', 'fontVariant', 'fontWeight', 'fontStretch', 'fontSize', 'fontSizeAdjust', 'lineHeight', 'fontFamily', 'textAlign', 'textTransform', 'textIndent', 'textDecoration', 'letterSpacing', 'wordSpacing'];\n\n            var isFirefox = window.mozInnerScreenX !== null;\n\n            var div = this.getDocument().createElement('div');\n            div.id = 'input-textarea-caret-position-mirror-div';\n            this.getDocument().body.appendChild(div);\n\n            var style = div.style;\n            var computed = window.getComputedStyle ? getComputedStyle(element) : element.currentStyle;\n\n            style.whiteSpace = 'pre-wrap';\n            if (element.nodeName !== 'INPUT') {\n                style.wordWrap = 'break-word';\n            }\n\n            // position off-screen\n            style.position = 'absolute';\n            style.visibility = 'hidden';\n\n            // transfer the element's properties to the div\n            properties.forEach(function (prop) {\n                style[prop] = computed[prop];\n            });\n\n            if (isFirefox) {\n                style.width = parseInt(computed.width) - 2 + 'px';\n                if (element.scrollHeight > parseInt(computed.height)) style.overflowY = 'scroll';\n            } else {\n                style.overflow = 'hidden';\n            }\n\n            div.textContent = element.value.substring(0, position);\n\n            if (element.nodeName === 'INPUT') {\n                div.textContent = div.textContent.replace(/\\s/g, ' ');\n            }\n\n            var span = this.getDocument().createElement('span');\n            span.textContent = element.value.substring(position) || '.';\n            div.appendChild(span);\n\n            var rect = element.getBoundingClientRect();\n            var doc = document.documentElement;\n            var windowLeft = (window.pageXOffset || doc.scrollLeft) - (doc.clientLeft || 0);\n            var windowTop = (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);\n\n            var coordinates = {\n                top: rect.top + windowTop + span.offsetTop + parseInt(computed.borderTopWidth) + parseInt(computed.fontSize) - element.scrollTop,\n                left: rect.left + windowLeft + span.offsetLeft + parseInt(computed.borderLeftWidth)\n            };\n\n            var windowWidth = window.innerWidth;\n            var windowHeight = window.innerHeight;\n\n            var menuDimensions = this.getMenuDimensions();\n            var menuIsOffScreen = this.isMenuOffScreen(coordinates, menuDimensions);\n\n            if (menuIsOffScreen.horizontally) {\n                coordinates.right = windowWidth - coordinates.left;\n                coordinates.left = 'auto';\n            }\n\n            var parentHeight = this.tribute.menuContainer ? this.tribute.menuContainer.offsetHeight : this.getDocument().body.offsetHeight;\n\n            if (menuIsOffScreen.vertically) {\n                var parentRect = this.tribute.menuContainer ? this.tribute.menuContainer.getBoundingClientRect() : this.getDocument().body.getBoundingClientRect();\n                var scrollStillAvailable = parentHeight - (windowHeight - parentRect.top);\n\n                coordinates.bottom = scrollStillAvailable + (windowHeight - rect.top - span.offsetTop);\n                coordinates.top = 'auto';\n            }\n\n            this.getDocument().body.removeChild(div);\n\n            return coordinates;\n        }\n    }, {\n        key: 'getContentEditableCaretPosition',\n        value: function getContentEditableCaretPosition(selectedNodePosition) {\n            var markerTextChar = '﻿';\n            var markerEl = void 0,\n                markerId = 'sel_' + new Date().getTime() + '_' + Math.random().toString().substr(2);\n            var range = void 0;\n            var sel = this.getWindowSelection();\n            var prevRange = sel.getRangeAt(0);\n\n            range = this.getDocument().createRange();\n            range.setStart(sel.anchorNode, selectedNodePosition);\n            range.setEnd(sel.anchorNode, selectedNodePosition);\n\n            range.collapse(false);\n\n            // Create the marker element containing a single invisible character using DOM methods and insert it\n            markerEl = this.getDocument().createElement('span');\n            markerEl.id = markerId;\n\n            markerEl.appendChild(this.getDocument().createTextNode(markerTextChar));\n            range.insertNode(markerEl);\n            sel.removeAllRanges();\n            sel.addRange(prevRange);\n\n            var rect = markerEl.getBoundingClientRect();\n            var doc = document.documentElement;\n            var windowLeft = (window.pageXOffset || doc.scrollLeft) - (doc.clientLeft || 0);\n            var windowTop = (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);\n            var coordinates = {\n                left: rect.left + windowLeft,\n                top: rect.top + markerEl.offsetHeight + windowTop\n            };\n            var windowWidth = window.innerWidth;\n            var windowHeight = window.innerHeight;\n\n            var menuDimensions = this.getMenuDimensions();\n            var menuIsOffScreen = this.isMenuOffScreen(coordinates, menuDimensions);\n\n            if (menuIsOffScreen.horizontally) {\n                coordinates.left = 'auto';\n                coordinates.right = windowWidth - rect.left - windowLeft;\n            }\n\n            var parentHeight = this.tribute.menuContainer ? this.tribute.menuContainer.offsetHeight : this.getDocument().body.offsetHeight;\n\n            if (menuIsOffScreen.vertically) {\n                var parentRect = this.tribute.menuContainer ? this.tribute.menuContainer.getBoundingClientRect() : this.getDocument().body.getBoundingClientRect();\n                var scrollStillAvailable = parentHeight - (windowHeight - parentRect.top);\n\n                windowLeft = (window.pageXOffset || doc.scrollLeft) - (doc.clientLeft || 0);\n                windowTop = (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);\n                coordinates.top = 'auto';\n                coordinates.bottom = scrollStillAvailable + (windowHeight - rect.top);\n            }\n\n            markerEl.parentNode.removeChild(markerEl);\n            return coordinates;\n        }\n    }, {\n        key: 'scrollIntoView',\n        value: function scrollIntoView(elem) {\n            var reasonableBuffer = 20,\n                clientRect = void 0;\n            var maxScrollDisplacement = 100;\n            var e = this.menu;\n\n            if (typeof e === 'undefined') return;\n\n            while (clientRect === undefined || clientRect.height === 0) {\n                clientRect = e.getBoundingClientRect();\n\n                if (clientRect.height === 0) {\n                    e = e.childNodes[0];\n                    if (e === undefined || !e.getBoundingClientRect) {\n                        return;\n                    }\n                }\n            }\n\n            var elemTop = clientRect.top;\n            var elemBottom = elemTop + clientRect.height;\n\n            if (elemTop < 0) {\n                window.scrollTo(0, window.pageYOffset + clientRect.top - reasonableBuffer);\n            } else if (elemBottom > window.innerHeight) {\n                var maxY = window.pageYOffset + clientRect.top - reasonableBuffer;\n\n                if (maxY - window.pageYOffset > maxScrollDisplacement) {\n                    maxY = window.pageYOffset + maxScrollDisplacement;\n                }\n\n                var targetY = window.pageYOffset - (window.innerHeight - elemBottom);\n\n                if (targetY > maxY) {\n                    targetY = maxY;\n                }\n\n                window.scrollTo(0, targetY);\n            }\n        }\n    }]);\n\n    return TributeRange;\n}();\n\nexports.default = TributeRange;\nmodule.exports = exports['default'];","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Thanks to https://github.com/mattyork/fuzzy\nvar TributeSearch = function () {\n    function TributeSearch(tribute) {\n        _classCallCheck(this, TributeSearch);\n\n        this.tribute = tribute;\n        this.tribute.search = this;\n    }\n\n    _createClass(TributeSearch, [{\n        key: 'simpleFilter',\n        value: function simpleFilter(pattern, array) {\n            var _this = this;\n\n            return array.filter(function (string) {\n                return _this.test(pattern, string);\n            });\n        }\n    }, {\n        key: 'test',\n        value: function test(pattern, string) {\n            return this.match(pattern, string) !== null;\n        }\n    }, {\n        key: 'match',\n        value: function match(pattern, string, opts) {\n            opts = opts || {};\n            var patternIdx = 0,\n                result = [],\n                len = string.length,\n                totalScore = 0,\n                currScore = 0,\n                pre = opts.pre || '',\n                post = opts.post || '',\n                compareString = opts.caseSensitive && string || string.toLowerCase(),\n                ch = void 0,\n                compareChar = void 0;\n\n            pattern = opts.caseSensitive && pattern || pattern.toLowerCase();\n\n            var patternCache = this.traverse(compareString, pattern, 0, 0, []);\n            if (!patternCache) {\n                return null;\n            }\n\n            return {\n                rendered: this.render(string, patternCache.cache, pre, post),\n                score: patternCache.score\n            };\n        }\n    }, {\n        key: 'traverse',\n        value: function traverse(string, pattern, stringIndex, patternIndex, patternCache) {\n            // if the pattern search at end\n            if (pattern.length === patternIndex) {\n\n                // calculate socre and copy the cache containing the indices where it's found\n                return {\n                    score: this.calculateScore(patternCache),\n                    cache: patternCache.slice()\n                };\n            }\n\n            // if string at end or remaining pattern > remaining string\n            if (string.length === stringIndex || pattern.length - patternIndex > string.length - stringIndex) {\n                return undefined;\n            }\n\n            var c = pattern[patternIndex];\n            var index = string.indexOf(c, stringIndex);\n            var best = void 0,\n                temp = void 0;\n\n            while (index > -1) {\n                patternCache.push(index);\n                temp = this.traverse(string, pattern, index + 1, patternIndex + 1, patternCache);\n                patternCache.pop();\n\n                // if downstream traversal failed, return best answer so far\n                if (!temp) {\n                    return best;\n                }\n\n                if (!best || best.score < temp.score) {\n                    best = temp;\n                }\n\n                index = string.indexOf(c, index + 1);\n            }\n\n            return best;\n        }\n    }, {\n        key: 'calculateScore',\n        value: function calculateScore(patternCache) {\n            var score = 0;\n            var temp = 1;\n\n            patternCache.forEach(function (index, i) {\n                if (i > 0) {\n                    if (patternCache[i - 1] + 1 === index) {\n                        temp += temp + 1;\n                    } else {\n                        temp = 1;\n                    }\n                }\n\n                score += temp;\n            });\n\n            return score;\n        }\n    }, {\n        key: 'render',\n        value: function render(string, indices, pre, post) {\n            var rendered = string.substring(0, indices[0]);\n\n            indices.forEach(function (index, i) {\n                rendered += pre + string[index] + post + string.substring(index + 1, indices[i + 1] ? indices[i + 1] : string.length);\n            });\n\n            return rendered;\n        }\n    }, {\n        key: 'filter',\n        value: function filter(pattern, arr, opts) {\n            var _this2 = this;\n\n            opts = opts || {};\n            return arr.reduce(function (prev, element, idx, arr) {\n                var str = element;\n\n                if (opts.extract) {\n                    str = opts.extract(element);\n\n                    if (!str) {\n                        // take care of undefineds / nulls / etc.\n                        str = '';\n                    }\n                }\n\n                var rendered = _this2.match(pattern, str, opts);\n\n                if (rendered != null) {\n                    prev[prev.length] = {\n                        string: rendered.rendered,\n                        score: rendered.score,\n                        index: idx,\n                        original: element\n                    };\n                }\n\n                return prev;\n            }, []).sort(function (a, b) {\n                var compare = b.score - a.score;\n                if (compare) return compare;\n                return a.index - b.index;\n            });\n        }\n    }]);\n\n    return TributeSearch;\n}();\n\nexports.default = TributeSearch;\nmodule.exports = exports['default'];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _utils = require(\"./utils\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _TributeEvents = require(\"./TributeEvents\");\n\nvar _TributeEvents2 = _interopRequireDefault(_TributeEvents);\n\nvar _TributeMenuEvents = require(\"./TributeMenuEvents\");\n\nvar _TributeMenuEvents2 = _interopRequireDefault(_TributeMenuEvents);\n\nvar _TributeRange = require(\"./TributeRange\");\n\nvar _TributeRange2 = _interopRequireDefault(_TributeRange);\n\nvar _TributeSearch = require(\"./TributeSearch\");\n\nvar _TributeSearch2 = _interopRequireDefault(_TributeSearch);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Tribute = function () {\n    function Tribute(_ref) {\n        var _this = this;\n\n        var _ref$values = _ref.values,\n            values = _ref$values === undefined ? null : _ref$values,\n            _ref$iframe = _ref.iframe,\n            iframe = _ref$iframe === undefined ? null : _ref$iframe,\n            _ref$selectClass = _ref.selectClass,\n            selectClass = _ref$selectClass === undefined ? 'highlight' : _ref$selectClass,\n            _ref$trigger = _ref.trigger,\n            trigger = _ref$trigger === undefined ? '@' : _ref$trigger,\n            _ref$selectTemplate = _ref.selectTemplate,\n            selectTemplate = _ref$selectTemplate === undefined ? null : _ref$selectTemplate,\n            _ref$menuItemTemplate = _ref.menuItemTemplate,\n            menuItemTemplate = _ref$menuItemTemplate === undefined ? null : _ref$menuItemTemplate,\n            _ref$lookup = _ref.lookup,\n            lookup = _ref$lookup === undefined ? 'key' : _ref$lookup,\n            _ref$fillAttr = _ref.fillAttr,\n            fillAttr = _ref$fillAttr === undefined ? 'value' : _ref$fillAttr,\n            _ref$collection = _ref.collection,\n            collection = _ref$collection === undefined ? null : _ref$collection,\n            _ref$menuContainer = _ref.menuContainer,\n            menuContainer = _ref$menuContainer === undefined ? null : _ref$menuContainer,\n            _ref$noMatchTemplate = _ref.noMatchTemplate,\n            noMatchTemplate = _ref$noMatchTemplate === undefined ? null : _ref$noMatchTemplate,\n            _ref$requireLeadingSp = _ref.requireLeadingSpace,\n            requireLeadingSpace = _ref$requireLeadingSp === undefined ? true : _ref$requireLeadingSp,\n            _ref$allowSpaces = _ref.allowSpaces,\n            allowSpaces = _ref$allowSpaces === undefined ? false : _ref$allowSpaces,\n            _ref$replaceTextSuffi = _ref.replaceTextSuffix,\n            replaceTextSuffix = _ref$replaceTextSuffi === undefined ? null : _ref$replaceTextSuffi,\n            _ref$positionMenu = _ref.positionMenu,\n            positionMenu = _ref$positionMenu === undefined ? true : _ref$positionMenu;\n\n        _classCallCheck(this, Tribute);\n\n        this.menuSelected = 0;\n        this.current = {};\n        this.inputEvent = false;\n        this.isActive = false;\n        this.menuContainer = menuContainer;\n        this.allowSpaces = allowSpaces;\n        this.replaceTextSuffix = replaceTextSuffix;\n        this.positionMenu = positionMenu;\n\n        if (values) {\n            this.collection = [{\n                // symbol that starts the lookup\n                trigger: trigger,\n\n                iframe: iframe,\n\n                selectClass: selectClass,\n\n                // function called on select that retuns the content to insert\n                selectTemplate: (selectTemplate || Tribute.defaultSelectTemplate).bind(this),\n\n                // function called that returns content for an item\n                menuItemTemplate: (menuItemTemplate || Tribute.defaultMenuItemTemplate).bind(this),\n\n                // function called when menu is empty, disables hiding of menu.\n                noMatchTemplate: function (t) {\n                    if (typeof t === 'function') {\n                        return t.bind(_this);\n                    }\n\n                    return noMatchTemplate;\n                }(noMatchTemplate),\n\n                // column to search against in the object\n                lookup: lookup,\n\n                // column that contains the content to insert by default\n                fillAttr: fillAttr,\n\n                // array of objects or a function returning an array of objects\n                values: values,\n\n                requireLeadingSpace: requireLeadingSpace\n            }];\n        } else if (collection) {\n            this.collection = collection.map(function (item) {\n                return {\n                    trigger: item.trigger || trigger,\n                    iframe: item.iframe || iframe,\n                    selectClass: item.selectClass || selectClass,\n                    selectTemplate: (item.selectTemplate || Tribute.defaultSelectTemplate).bind(_this),\n                    menuItemTemplate: (item.menuItemTemplate || Tribute.defaultMenuItemTemplate).bind(_this),\n                    // function called when menu is empty, disables hiding of menu.\n                    noMatchTemplate: function (t) {\n                        if (typeof t === 'function') {\n                            return t.bind(_this);\n                        }\n\n                        return null;\n                    }(noMatchTemplate),\n                    lookup: item.lookup || lookup,\n                    fillAttr: item.fillAttr || fillAttr,\n                    values: item.values,\n                    requireLeadingSpace: item.requireLeadingSpace\n                };\n            });\n        } else {\n            throw new Error('[Tribute] No collection specified.');\n        }\n\n        new _TributeRange2.default(this);\n        new _TributeEvents2.default(this);\n        new _TributeMenuEvents2.default(this);\n        new _TributeSearch2.default(this);\n    }\n\n    _createClass(Tribute, [{\n        key: \"triggers\",\n        value: function triggers() {\n            return this.collection.map(function (config) {\n                return config.trigger;\n            });\n        }\n    }, {\n        key: \"attach\",\n        value: function attach(el) {\n            if (!el) {\n                throw new Error('[Tribute] Must pass in a DOM node or NodeList.');\n            }\n\n            // Check if it is a jQuery collection\n            if (typeof jQuery !== 'undefined' && el instanceof jQuery) {\n                el = el.get();\n            }\n\n            // Is el an Array/Array-like object?\n            if (el.constructor === NodeList || el.constructor === HTMLCollection || el.constructor === Array) {\n                var length = el.length;\n                for (var i = 0; i < length; ++i) {\n                    this._attach(el[i]);\n                }\n            } else {\n                this._attach(el);\n            }\n        }\n    }, {\n        key: \"_attach\",\n        value: function _attach(el) {\n            if (el.hasAttribute('data-tribute')) {\n                console.warn('Tribute was already bound to ' + el.nodeName);\n            }\n\n            this.ensureEditable(el);\n            this.events.bind(el);\n            el.setAttribute('data-tribute', true);\n        }\n    }, {\n        key: \"ensureEditable\",\n        value: function ensureEditable(element) {\n            if (Tribute.inputTypes().indexOf(element.nodeName) === -1) {\n                if (element.contentEditable) {\n                    element.contentEditable = true;\n                } else {\n                    throw new Error('[Tribute] Cannot bind to ' + element.nodeName);\n                }\n            }\n        }\n    }, {\n        key: \"createMenu\",\n        value: function createMenu() {\n            var wrapper = this.range.getDocument().createElement('div'),\n                ul = this.range.getDocument().createElement('ul');\n\n            wrapper.className = 'tribute-container';\n            wrapper.appendChild(ul);\n\n            if (this.menuContainer) {\n                return this.menuContainer.appendChild(wrapper);\n            }\n\n            return this.range.getDocument().body.appendChild(wrapper);\n        }\n    }, {\n        key: \"showMenuFor\",\n        value: function showMenuFor(element, scrollTo) {\n            var _this2 = this;\n\n            // Only proceed if menu isn't already shown for the current element & mentionText\n            if (this.isActive && this.current.element === element && this.current.mentionText === this.currentMentionTextSnapshot) {\n                return;\n            }\n            this.currentMentionTextSnapshot = this.current.mentionText;\n\n            // create the menu if it doesn't exist.\n            if (!this.menu) {\n                this.menu = this.createMenu();\n                element.tributeMenu = this.menu;\n                this.menuEvents.bind(this.menu);\n            }\n\n            this.isActive = true;\n            this.menuSelected = 0;\n\n            if (!this.current.mentionText) {\n                this.current.mentionText = '';\n            }\n\n            var processValues = function processValues(values) {\n                // Tribute may not be active any more by the time the value callback returns\n                if (!_this2.isActive) {\n                    return;\n                }\n\n                var items = _this2.search.filter(_this2.current.mentionText, values, {\n                    pre: '<span>',\n                    post: '</span>',\n                    extract: function extract(el) {\n                        if (typeof _this2.current.collection.lookup === 'string') {\n                            return el[_this2.current.collection.lookup];\n                        } else if (typeof _this2.current.collection.lookup === 'function') {\n                            return _this2.current.collection.lookup(el);\n                        } else {\n                            throw new Error('Invalid lookup attribute, lookup must be string or function.');\n                        }\n                    }\n                });\n\n                _this2.current.filteredItems = items;\n\n                var ul = _this2.menu.querySelector('ul');\n\n                _this2.range.positionMenuAtCaret(scrollTo);\n\n                if (!items.length) {\n                    var noMatchEvent = new CustomEvent('tribute-no-match', { detail: _this2.menu });\n                    _this2.current.element.dispatchEvent(noMatchEvent);\n                    if (!_this2.current.collection.noMatchTemplate) {\n                        _this2.hideMenu();\n                    } else {\n                        ul.innerHTML = _this2.current.collection.noMatchTemplate();\n                    }\n\n                    return;\n                }\n\n                ul.innerHTML = '';\n\n                items.forEach(function (item, index) {\n                    var li = _this2.range.getDocument().createElement('li');\n                    li.setAttribute('data-index', index);\n                    li.addEventListener('mouseenter', function (e) {\n                        var li = e.target;\n                        var index = li.getAttribute('data-index');\n                        _this2.events.setActiveLi(index);\n                    });\n                    if (_this2.menuSelected === index) {\n                        li.className = _this2.current.collection.selectClass;\n                    }\n                    li.innerHTML = _this2.current.collection.menuItemTemplate(item);\n                    ul.appendChild(li);\n                });\n            };\n\n            if (typeof this.current.collection.values === 'function') {\n                this.current.collection.values(this.current.mentionText, processValues);\n            } else {\n                processValues(this.current.collection.values);\n            }\n        }\n    }, {\n        key: \"showMenuForCollection\",\n        value: function showMenuForCollection(element, collectionIndex) {\n            if (element !== document.activeElement) {\n                this.placeCaretAtEnd(element);\n            }\n\n            this.current.collection = this.collection[collectionIndex || 0];\n            this.current.externalTrigger = true;\n            this.current.element = element;\n\n            if (element.isContentEditable) this.insertTextAtCursor(this.current.collection.trigger);else this.insertAtCaret(element, this.current.collection.trigger);\n\n            this.showMenuFor(element);\n        }\n\n        // TODO: make sure this works for inputs/textareas\n\n    }, {\n        key: \"placeCaretAtEnd\",\n        value: function placeCaretAtEnd(el) {\n            el.focus();\n            if (typeof window.getSelection != \"undefined\" && typeof document.createRange != \"undefined\") {\n                var range = document.createRange();\n                range.selectNodeContents(el);\n                range.collapse(false);\n                var sel = window.getSelection();\n                sel.removeAllRanges();\n                sel.addRange(range);\n            } else if (typeof document.body.createTextRange != \"undefined\") {\n                var textRange = document.body.createTextRange();\n                textRange.moveToElementText(el);\n                textRange.collapse(false);\n                textRange.select();\n            }\n        }\n\n        // for contenteditable\n\n    }, {\n        key: \"insertTextAtCursor\",\n        value: function insertTextAtCursor(text) {\n            var sel, range, html;\n            sel = window.getSelection();\n            range = sel.getRangeAt(0);\n            range.deleteContents();\n            var textNode = document.createTextNode(text);\n            range.insertNode(textNode);\n            range.selectNodeContents(textNode);\n            range.collapse(false);\n            sel.removeAllRanges();\n            sel.addRange(range);\n        }\n\n        // for regular inputs\n\n    }, {\n        key: \"insertAtCaret\",\n        value: function insertAtCaret(textarea, text) {\n            var scrollPos = textarea.scrollTop;\n            var caretPos = textarea.selectionStart;\n\n            var front = textarea.value.substring(0, caretPos);\n            var back = textarea.value.substring(textarea.selectionEnd, textarea.value.length);\n            textarea.value = front + text + back;\n            caretPos = caretPos + text.length;\n            textarea.selectionStart = caretPos;\n            textarea.selectionEnd = caretPos;\n            textarea.focus();\n            textarea.scrollTop = scrollPos;\n        }\n    }, {\n        key: \"hideMenu\",\n        value: function hideMenu() {\n            if (this.menu) {\n                this.menu.style.cssText = 'display: none;';\n                this.isActive = false;\n                this.menuSelected = 0;\n                this.current = {};\n            }\n        }\n    }, {\n        key: \"selectItemAtIndex\",\n        value: function selectItemAtIndex(index, originalEvent) {\n            index = parseInt(index);\n            if (typeof index !== 'number') return;\n            var item = this.current.filteredItems[index];\n            var content = this.current.collection.selectTemplate(item);\n            if (content !== null) this.replaceText(content, originalEvent, item);\n        }\n    }, {\n        key: \"replaceText\",\n        value: function replaceText(content, originalEvent, item) {\n            this.range.replaceTriggerText(content, true, true, originalEvent, item);\n        }\n    }, {\n        key: \"_append\",\n        value: function _append(collection, newValues, replace) {\n            if (typeof collection.values === 'function') {\n                throw new Error('Unable to append to values, as it is a function.');\n            } else if (!replace) {\n                collection.values = collection.values.concat(newValues);\n            } else {\n                collection.values = newValues;\n            }\n        }\n    }, {\n        key: \"append\",\n        value: function append(collectionIndex, newValues, replace) {\n            var index = parseInt(collectionIndex);\n            if (typeof index !== 'number') throw new Error('please provide an index for the collection to update.');\n\n            var collection = this.collection[index];\n\n            this._append(collection, newValues, replace);\n        }\n    }, {\n        key: \"appendCurrent\",\n        value: function appendCurrent(newValues, replace) {\n            if (this.isActive) {\n                this._append(this.current.collection, newValues, replace);\n            } else {\n                throw new Error('No active state. Please use append instead and pass an index.');\n            }\n        }\n    }, {\n        key: \"detach\",\n        value: function detach(el) {\n            if (!el) {\n                throw new Error('[Tribute] Must pass in a DOM node or NodeList.');\n            }\n\n            // Check if it is a jQuery collection\n            if (typeof jQuery !== 'undefined' && el instanceof jQuery) {\n                el = el.get();\n            }\n\n            // Is el an Array/Array-like object?\n            if (el.constructor === NodeList || el.constructor === HTMLCollection || el.constructor === Array) {\n                var length = el.length;\n                for (var i = 0; i < length; ++i) {\n                    this._detach(el[i]);\n                }\n            } else {\n                this._detach(el);\n            }\n        }\n    }, {\n        key: \"_detach\",\n        value: function _detach(el) {\n            var _this3 = this;\n\n            this.events.unbind(el);\n            this.menuEvents.unbind(el.tributeMenu);\n\n            setTimeout(function () {\n                el.removeAttribute('data-tribute');\n                _this3.isActive = false;\n                el.tributeMenu.remove();\n            });\n        }\n    }], [{\n        key: \"defaultSelectTemplate\",\n        value: function defaultSelectTemplate(item) {\n            if (typeof item === 'undefined') return null;\n            if (this.range.isContentEditable(this.current.element)) {\n                return '<span class=\"tribute-mention\">' + (this.current.collection.trigger + item.original[this.current.collection.fillAttr]) + '</span>';\n            }\n\n            return this.current.collection.trigger + item.original[this.current.collection.fillAttr];\n        }\n    }, {\n        key: \"defaultMenuItemTemplate\",\n        value: function defaultMenuItemTemplate(matchItem) {\n            return matchItem.string;\n        }\n    }, {\n        key: \"inputTypes\",\n        value: function inputTypes() {\n            return ['TEXTAREA', 'INPUT'];\n        }\n    }]);\n\n    return Tribute;\n}();\n\nexports.default = Tribute;\nmodule.exports = exports[\"default\"];","import Tribute from 'tributejs'\r\n\r\nconst VueTribute = {\r\n  name: 'vue-tribute',\r\n  props: {\r\n    options: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      tribute: null\r\n    }\r\n  },\r\n  mounted() {\r\n    const $el = this.$slots.default[0].elm\r\n    this.createTributeInstance($el, this.options)\r\n  },\r\n  watch: {\r\n    options: {\r\n      handler: function (newVal) {\r\n        this.$nextTick(()=>{ // recreate the tribute instance for newest options\r\n          const $el = this.$slots.default[0].elm\r\n          if(this.tribute instanceof Tribute) {\r\n            if (!this.tribute.menu) { // if menu doesn't exists, tribute.detach will popup one error\r\n              this.tribute.menu = this.tribute.createMenu()\r\n              $el.tributeMenu = this.tribute.menu\r\n            }\r\n            this.tribute.detach($el)\r\n            this.tribute = null\r\n          }\r\n          this.createTributeInstance($el, newVal)\r\n        })\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  methods: {\r\n    createTributeInstance: function (el, options) {\r\n      this.tribute = new Tribute(options)\r\n      this.tribute.attach(el)\r\n      el.addEventListener('tribute-replaced', e => {\r\n        this.$emit('tribute-replaced', e)\r\n      })\r\n\r\n      el.addEventListener('tribute-no-match', e => {\r\n        this.$emit('tribute-no-match', e)\r\n      })\r\n    }\r\n  },\r\n  render(h) {\r\n    return h(\r\n      'div',\r\n      {\r\n        staticClass: 'v-tribute'\r\n      },\r\n      this.$slots.default\r\n    )\r\n  }\r\n}\r\n\r\nif (typeof window !== 'undefined' && window.Vue) {\r\n  window.Vue.component(VueTribute.name, VueTribute)\r\n}\r\n\r\nexport default VueTribute\r\n"],"names":["Array","prototype","find","predicate","this","TypeError","value","list","Object","length","thisArg","arguments","i","call","window","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","document","createEvent","initCustomEvent","Event","defineProperty","exports","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","TributeEvents","tribute","instance","_classCallCheck","events","element","boundKeydown","keydown","bind","boundKeyup","keyup","boundInput","input","addEventListener","removeEventListener","shouldDeactivate","isActive","hideMenu","commandEvent","keys","forEach","o","keyCode","callbacks","toLowerCase","inputEvent","menu","contains","li","preventDefault","stopPropagation","nodeName","parentNode","Error","selectItemAtIndex","getAttribute","current","externalTrigger","setTimeout","updateSelection","getKeyCode","isNaN","trigger","triggers","charCodeAt","triggerChar","showMenuFor","mentionText","eventKeyPressed","el","info","range","getTriggerInfo","allowSpaces","mentionTriggerChar","selectedPath","mentionSelectedPath","selectedOffset","mentionSelectedOffset","_this","e","collectionItem","collection","item","enter","menuSelected","escape","tab","up","count","filteredItems","selected","setActiveLi","scrollTop","scrollHeight","down","delete","index","lis","querySelectorAll","menuFullHeight","getFullHeight","liHeight","offset","totalScroll","className","selectClass","elem","includeMargin","height","getBoundingClientRect","style","currentStyle","getComputedStyle","parseFloat","marginTop","marginBottom","module","TributeMenuEvents","menuEvents","menuKeydownEvent","menuClickEvent","click","menuContainerScrollEvent","debounce","windowResizeEvent","positionMenuAtCaret","getDocument","menuContainer","func","wait","immediate","timeout","_this2","_arguments","context","args","callNow","clearTimeout","apply","TributeRange","iframe","contentWindow","scrollTo","coordinates","positionMenu","cssText","isContentEditable","getContentEditableCaretPosition","mentionPosition","getTextAreaOrInputUnderlinePosition","activeElement","top","left","right","bottom","scrollIntoView","menuDimensions","width","offsetWidth","offsetHeight","menuIsOffScreen","isMenuOffScreen","horizontally","vertically","targetElement","path","childNodes","nextSibling","previousSibling","sel","getWindowSelection","createRange","setStart","setEnd","collapse","removeAllRanges","error","addRange","focus","selectElement","text","requireLeadingSpace","hasTrailingSpace","originalEvent","replaceEvent","replaceTextSuffix","pasteHtml","myField","textSuffix","startPos","endPos","substring","selectionStart","selectionEnd","dispatchEvent","html","anchorNode","deleteContents","createElement","innerHTML","frag","createDocumentFragment","node","lastNode","firstChild","appendChild","insertNode","cloneRange","setStartAfter","getSelection","ctx","ce","contentEditable","getNodePositionInParent","push","reverse","getRangeAt","startOffset","selectedElem","workingNodeContent","textContent","selectStartOffset","textComponent","menuAlreadyActive","selectionInfo","getContentEditableSelectedPath","effectiveRange","getTextPrecedingCurrentSelection","mostRecentTriggerCharPos","config","c","idx","lastIndexWithLeadingSpace","lastIndexOf","test","currentTriggerSnippet","firstSnippetChar","leadingSpace","trim","mentionSelectedElement","str","char","reversedStr","split","join","cidx","len","firstChar","contentWidth","contentHeight","windowWidth","innerWidth","windowHeight","innerHeight","doc","documentElement","windowLeft","pageXOffset","scrollLeft","clientLeft","windowTop","pageYOffset","clientTop","Math","ceil","dimensions","position","flipped","isFirefox","mozInnerScreenX","div","id","body","computed","whiteSpace","wordWrap","visibility","prop","parseInt","overflowY","overflow","replace","span","rect","offsetTop","borderTopWidth","fontSize","offsetLeft","borderLeftWidth","getMenuDimensions","parentHeight","scrollStillAvailable","removeChild","selectedNodePosition","markerEl","markerId","Date","getTime","random","toString","substr","prevRange","createTextNode","clientRect","elemTop","elemBottom","maxY","targetY","TributeSearch","search","pattern","array","filter","string","match","opts","pre","post","compareString","caseSensitive","patternCache","traverse","rendered","render","cache","score","stringIndex","patternIndex","calculateScore","slice","indexOf","best","temp","pop","indices","arr","reduce","prev","extract","original","sort","a","b","compare","_TributeEvents2","_interopRequireDefault","_utils","_TributeEvents","_TributeMenuEvents2","_TributeMenuEvents","_TributeRange2","_TributeRange","_TributeSearch2","_TributeSearch","obj","__esModule","default","Tribute","_ref","_ref$values","values","_ref$iframe","_ref$selectClass","_ref$trigger","_ref$selectTemplate","selectTemplate","_ref$menuItemTemplate","menuItemTemplate","_ref$lookup","lookup","_ref$fillAttr","fillAttr","_ref$collection","_ref$menuContainer","_ref$noMatchTemplate","noMatchTemplate","_ref$requireLeadingSp","_ref$allowSpaces","_ref$replaceTextSuffi","_ref$positionMenu","defaultSelectTemplate","defaultMenuItemTemplate","map","jQuery","get","constructor","NodeList","HTMLCollection","_attach","hasAttribute","console","warn","ensureEditable","setAttribute","inputTypes","wrapper","ul","currentMentionTextSnapshot","createMenu","tributeMenu","processValues","items","querySelector","noMatchEvent","collectionIndex","placeCaretAtEnd","insertTextAtCursor","insertAtCaret","selectNodeContents","createTextRange","textRange","moveToElementText","select","textNode","textarea","scrollPos","caretPos","front","back","content","replaceText","replaceTriggerText","newValues","concat","_append","_detach","_this3","unbind","removeAttribute","remove","matchItem","VueTribute","name","options","type","required","data","mounted","$el","$slots","elm","createTributeInstance","watch","handler","newVal","$nextTick","detach","deep","methods","attach","$emit","h","staticClass","Vue","component"],"mappings":"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"}